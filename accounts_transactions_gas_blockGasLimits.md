# 以太坊上的账户，交易，GAS，以及区块gas limit   
                                                                    --Hudson Jameson
## 什么是账户？
### EOA vs 合约账户
以太坊上有两种类型的账户：
* 外部拥有账户(Externally Owned Accounts)
* 合约账户
这个区别将会在即将到来的大都会版本升级中抽象出来。
#### 外部拥有账户(EOA)
一个外部控制的账户
* 拥有一个以太余额
* 可以发送交易(以太转账或者触发合约代码)
* 由私钥控制
* 没有相关代码
#### 合约账户
一个合约
* 拥有一个以太余额
* 拥有相关代码
* 由交易或者从其他合约收到的消息(call)触发执行代码
* 当执行的时候-执行任意复杂的操作(图灵完备)-操作它自己的持续储存，也就是说，可以拥有它自己的永久的状态-能够调用其他合约。

通过从账户触发的交易，以太坊区块链上所有的操作都将启动。每次一个合约账户收到一个交易，它的代码是按照作为交易的一部分发送的输入参数执行的。合约代码由每个作为验证新块的一部分参与到的网络中的节点上的EVM执行。
## 什么是交易和消息？
### 交易
以太坊使用的“交易”一词是指经过签名的数据包，其中数据包中存储着从区块链上一个外部拥有账户到另一个账户的消息。  ***Prob:合约账户不可以吗？目前不可以，无法完成签名***

交易包括：
* 消息的接收者，
* 一个签名，可以认证发送者并且证明他们通过区块链发送消息给接收者的意图,
* <font color=red>VALUE</font> 字段 - 从发送者转到接收者的wei的数量，
* 一个可选的数据段，可以包含发送给合约的消息，
* 一个<font color=red>GASLIMIT</font>值，代表允许交易运行计算步数的最大值，
* 一个<font color=red>GASPRICE</font>值，代表发送者愿意为gas花费的费用。一个gas单位对应一个原子指令的执行，也就是一个计算步骤。
### 消息
合约有发送给其他合约“消息”的能力。消息是一个从未序列化的虚拟对象，并且只存在以太坊运行环境中。它们可以被认为是函数调用。

一个消息包含：
* 消息的发送者(隐式的)
* 消息的接收者
* <font color=red>GASPRICE</font>字段 - 附着在消息上转给合约地址的wei的数量，
* 一个可选的数据段，合约实际的输入数据
* 一个<font color=red>GASPRICE</font>值，其限制由消息触发的代码运行所产生的gas的最大数量。

基本上，一个消息就像一个交易，除了它是由合约生成并且不是一个外部的执行者(actor)。当正在执行代码的合约执行<font color=red>CALL</font>或者<font color=red>DELEGATECALL</font>操作码时，就生成了一个消息，合约可以生成并执行消息。消息有时也会被称作“内部交易”。就像一个交易，一个消息可以导致接收账户运行其代码。如此，合约就可以和其他合约有与外部执行者(actors)完全相同的关系。很多时候人们使用交易这个术语，实际上他们指的是消息，所以有可能这个术语会通过社区共识不使用它而逐步淘汰。
## 什么是GAS？
以太坊在区块链上实现了一个叫做以太坊虚拟机(EVM)的执行环境。每一个参与网络的节点作为区块验证协议的一部分都运行EVM。他们通过(go through)正在验证的区块中列出的交易，并且在EVM中运行由交易触发的代码。网络上的每个完整节点做同样的运算并且存储同样的值。合约的执行在节点间冗余复制，这个事实自然地使其变得昂贵，这样，通常就会激励人们对那些可以在链下完成的计算不放在区块链上进行。对每一个执行的操作都会有一个明确的成本，其由若干gas单位表示。合约能够利用的每个操作都有一个相关的gas值。[这是一个过期的每个操作码(opcode)对应的gas成本的列表](https://docs.google.com/spreadsheets/d/1m89CVujrQe5LAFJ8-YAUCcNK950dUzMQPMJBxRtGCqs/edit#gid=0).
### Gas以及交易成本
每一个交易被要求包括一个gas limit(有时候也被称为<font color=red>startGas</font>)和愿意为每个gas花费的费用。矿工可以选择是否包括这些交易并获取这些费用。实际上，如今所有的交易最终都会被矿工打包，但是使用者选择发送的交易费用的数量会影响这个交易被挖到的时间。如果
